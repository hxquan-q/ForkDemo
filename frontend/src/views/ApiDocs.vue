<template>
  <div class="api-docs-container">
    <div class="header-section">
      <h2>ğŸ“š APIæ¥å£æ–‡æ¡£</h2>
    </div>

    <el-tabs v-model="activeTab" type="border-card">
      <!-- ç”¨æˆ·æœåŠ¡ -->
      <el-tab-pane label="ğŸ‘¤ ç”¨æˆ·æœåŠ¡" name="user">
        <div class="service-intro">
          <h3>ç”¨æˆ·æœåŠ¡ (User Service)</h3>
          <p>è´Ÿè´£ç”¨æˆ·è®¤è¯ã€ç”¨æˆ·ä¿¡æ¯ç®¡ç†ç­‰åŠŸèƒ½</p>
          <p><strong>æœåŠ¡åœ°å€:</strong> http://localhost:9001</p>
        </div>

        <div class="api-section">
          <h4>POST /api/user/login</h4>
          <p class="api-desc">ç”¨æˆ·ç™»å½•æ¥å£</p>
          
          <el-descriptions :column="1" border>
            <el-descriptions-item label="è¯·æ±‚æ–¹å¼">POST</el-descriptions-item>
            <el-descriptions-item label="è¯·æ±‚è·¯å¾„">/api/user/login</el-descriptions-item>
            <el-descriptions-item label="Content-Type">application/json</el-descriptions-item>
          </el-descriptions>

          <h5>è¯·æ±‚å‚æ•°</h5>
          <el-table :data="userLoginParams" border>
            <el-table-column prop="name" label="å‚æ•°å" width="120" />
            <el-table-column prop="type" label="ç±»å‹" width="100" />
            <el-table-column prop="required" label="å¿…å¡«" width="80">
              <template #default="scope">
                <el-tag :type="scope.row.required ? 'danger' : 'info'" size="small">
                  {{ scope.row.required ? 'æ˜¯' : 'å¦' }}
                </el-tag>
              </template>
            </el-table-column>
            <el-table-column prop="description" label="è¯´æ˜" />
          </el-table>

          <h5>è¯·æ±‚ç¤ºä¾‹</h5>
          <pre class="code-block">{{ userLoginExample }}</pre>

          <h5>å“åº”ç¤ºä¾‹</h5>
          <pre class="code-block">{{ userLoginResponse }}</pre>
        </div>

        <div class="api-section">
          <h4>GET /api/user/info</h4>
          <p class="api-desc">è·å–ç”¨æˆ·ä¿¡æ¯</p>
          
          <el-descriptions :column="1" border>
            <el-descriptions-item label="è¯·æ±‚æ–¹å¼">GET</el-descriptions-item>
            <el-descriptions-item label="è¯·æ±‚è·¯å¾„">/api/user/info</el-descriptions-item>
          </el-descriptions>

          <h5>è¯·æ±‚å‚æ•°</h5>
          <el-table :data="userInfoParams" border>
            <el-table-column prop="name" label="å‚æ•°å" width="120" />
            <el-table-column prop="type" label="ç±»å‹" width="100" />
            <el-table-column prop="required" label="å¿…å¡«" width="80">
              <template #default="scope">
                <el-tag :type="scope.row.required ? 'danger' : 'info'" size="small">
                  {{ scope.row.required ? 'æ˜¯' : 'å¦' }}
                </el-tag>
              </template>
            </el-table-column>
            <el-table-column prop="description" label="è¯´æ˜" />
          </el-table>

          <h5>å“åº”ç¤ºä¾‹</h5>
          <pre class="code-block">{{ userInfoResponse }}</pre>
        </div>
      </el-tab-pane>

      <!-- å•†å“æœåŠ¡ -->
      <el-tab-pane label="ğŸ›ï¸ å•†å“æœåŠ¡" name="product">
        <div class="service-intro">
          <h3>å•†å“æœåŠ¡ (Product Service)</h3>
          <p>è´Ÿè´£å•†å“ç®¡ç†ã€åº“å­˜ç®¡ç†ã€ç§’æ€é€»è¾‘ç­‰åŠŸèƒ½</p>
          <p><strong>æœåŠ¡åœ°å€:</strong> http://localhost:9002</p>
        </div>

        <div class="api-section">
          <h4>GET /api/product/list</h4>
          <p class="api-desc">è·å–å•†å“åˆ—è¡¨</p>
          
          <el-descriptions :column="1" border>
            <el-descriptions-item label="è¯·æ±‚æ–¹å¼">GET</el-descriptions-item>
            <el-descriptions-item label="è¯·æ±‚è·¯å¾„">/api/product/list</el-descriptions-item>
          </el-descriptions>

          <h5>å“åº”ç¤ºä¾‹</h5>
          <pre class="code-block">{{ productListResponse }}</pre>
        </div>

        <div class="api-section">
          <h4>POST /api/seckill/start</h4>
          <p class="api-desc">å¼€å§‹ç§’æ€</p>
          
          <el-descriptions :column="1" border>
            <el-descriptions-item label="è¯·æ±‚æ–¹å¼">POST</el-descriptions-item>
            <el-descriptions-item label="è¯·æ±‚è·¯å¾„">/api/seckill/start</el-descriptions-item>
            <el-descriptions-item label="Content-Type">application/json</el-descriptions-item>
          </el-descriptions>

          <h5>è¯·æ±‚å‚æ•°</h5>
          <el-table :data="seckillParams" border>
            <el-table-column prop="name" label="å‚æ•°å" width="120" />
            <el-table-column prop="type" label="ç±»å‹" width="100" />
            <el-table-column prop="required" label="å¿…å¡«" width="80">
              <template #default="scope">
                <el-tag :type="scope.row.required ? 'danger' : 'info'" size="small">
                  {{ scope.row.required ? 'æ˜¯' : 'å¦' }}
                </el-tag>
              </template>
            </el-table-column>
            <el-table-column prop="description" label="è¯´æ˜" />
          </el-table>

          <h5>è¯·æ±‚ç¤ºä¾‹</h5>
          <pre class="code-block">{{ seckillExample }}</pre>

          <h5>å“åº”ç¤ºä¾‹</h5>
          <pre class="code-block">{{ seckillResponse }}</pre>
        </div>
      </el-tab-pane>

      <!-- è®¢å•æœåŠ¡ -->
      <el-tab-pane label="ğŸ“‹ è®¢å•æœåŠ¡" name="order">
        <div class="service-intro">
          <h3>è®¢å•æœåŠ¡ (Order Service)</h3>
          <p>è´Ÿè´£è®¢å•åˆ›å»ºã€è®¢å•æŸ¥è¯¢ã€è®¢å•çŠ¶æ€ç®¡ç†ç­‰åŠŸèƒ½</p>
          <p><strong>æœåŠ¡åœ°å€:</strong> http://localhost:9003</p>
        </div>

        <div class="api-section">
          <h4>GET /api/order/list</h4>
          <p class="api-desc">è·å–è®¢å•åˆ—è¡¨</p>
          
          <el-descriptions :column="1" border>
            <el-descriptions-item label="è¯·æ±‚æ–¹å¼">GET</el-descriptions-item>
            <el-descriptions-item label="è¯·æ±‚è·¯å¾„">/api/order/list</el-descriptions-item>
          </el-descriptions>

          <h5>è¯·æ±‚å‚æ•°</h5>
          <el-table :data="orderListParams" border>
            <el-table-column prop="name" label="å‚æ•°å" width="120" />
            <el-table-column prop="type" label="ç±»å‹" width="100" />
            <el-table-column prop="required" label="å¿…å¡«" width="80">
              <template #default="scope">
                <el-tag :type="scope.row.required ? 'danger' : 'info'" size="small">
                  {{ scope.row.required ? 'æ˜¯' : 'å¦' }}
                </el-tag>
              </template>
            </el-table-column>
            <el-table-column prop="description" label="è¯´æ˜" />
          </el-table>

          <h5>å“åº”ç¤ºä¾‹</h5>
          <pre class="code-block">{{ orderListResponse }}</pre>
        </div>
      </el-tab-pane>

      <!-- é€šç”¨è¯´æ˜ -->
      <el-tab-pane label="ğŸ“– é€šç”¨è¯´æ˜" name="common">
        <div class="common-docs">
          <h3>é€šç”¨å“åº”æ ¼å¼</h3>
          <p>æ‰€æœ‰APIæ¥å£éƒ½éµå¾ªç»Ÿä¸€çš„å“åº”æ ¼å¼ï¼š</p>
          <pre class="code-block">{
  "success": true,
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": { ... }
}</pre>

          <h3>çŠ¶æ€ç è¯´æ˜</h3>
          <el-table :data="statusCodes" border>
            <el-table-column prop="code" label="çŠ¶æ€ç " width="100" />
            <el-table-column prop="message" label="è¯´æ˜" />
          </el-table>

          <h3>é”™è¯¯å¤„ç†</h3>
          <p>å½“è¯·æ±‚å¤±è´¥æ—¶ï¼Œå“åº”æ ¼å¼å¦‚ä¸‹ï¼š</p>
          <pre class="code-block">{
  "success": false,
  "code": 400,
  "message": "è¯·æ±‚å‚æ•°é”™è¯¯",
  "data": null
}</pre>

          <h3>è®¤è¯è¯´æ˜</h3>
          <p>éƒ¨åˆ†æ¥å£éœ€è¦ç”¨æˆ·è®¤è¯ï¼Œè¯·åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ ï¼š</p>
          <pre class="code-block">Authorization: Bearer &lt;token&gt;</pre>
        </div>
      </el-tab-pane>
    </el-tabs>
  </div>
</template>

<script setup>
import { ref } from 'vue'

const activeTab = ref('user')

// ç”¨æˆ·ç™»å½•å‚æ•°
const userLoginParams = [
  { name: 'username', type: 'string', required: true, description: 'ç”¨æˆ·å' },
  { name: 'password', type: 'string', required: true, description: 'å¯†ç ' }
]

// ç”¨æˆ·ä¿¡æ¯å‚æ•°
const userInfoParams = [
  { name: 'id', type: 'number', required: true, description: 'ç”¨æˆ·ID' }
]

// ç§’æ€å‚æ•°
const seckillParams = [
  { name: 'productId', type: 'number', required: true, description: 'å•†å“ID' },
  { name: 'userId', type: 'number', required: true, description: 'ç”¨æˆ·ID' }
]

// è®¢å•åˆ—è¡¨å‚æ•°
const orderListParams = [
  { name: 'userId', type: 'number', required: true, description: 'ç”¨æˆ·ID' },
  { name: 'page', type: 'number', required: false, description: 'é¡µç ï¼Œé»˜è®¤1' },
  { name: 'size', type: 'number', required: false, description: 'æ¯é¡µå¤§å°ï¼Œé»˜è®¤10' }
]

// çŠ¶æ€ç 
const statusCodes = [
  { code: 200, message: 'è¯·æ±‚æˆåŠŸ' },
  { code: 400, message: 'è¯·æ±‚å‚æ•°é”™è¯¯' },
  { code: 401, message: 'æœªæˆæƒ' },
  { code: 403, message: 'ç¦æ­¢è®¿é—®' },
  { code: 404, message: 'èµ„æºä¸å­˜åœ¨' },
  { code: 500, message: 'æœåŠ¡å™¨å†…éƒ¨é”™è¯¯' }
]

// ç¤ºä¾‹æ•°æ®
const userLoginExample = `{
  "username": "admin",
  "password": "123456"
}`

const userLoginResponse = `{
  "success": true,
  "code": 200,
  "message": "ç™»å½•æˆåŠŸ",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "user": {
      "id": 1,
      "username": "admin",
      "phone": "13800000000",
      "email": "admin@example.com"
    }
  }
}`

const userInfoResponse = `{
  "success": true,
  "code": 200,
  "message": "è·å–æˆåŠŸ",
  "data": {
    "id": 1,
    "username": "admin",
    "phone": "13800000000",
    "email": "admin@example.com",
    "createTime": "2024-01-01T00:00:00"
  }
}`

const productListResponse = `{
  "success": true,
  "code": 200,
  "message": "è·å–æˆåŠŸ",
  "data": [
    {
      "id": 1,
      "name": "iPhone 15 Pro",
      "description": "Apple iPhone 15 Pro 256GB",
      "price": 8999.00,
      "seckillPrice": 7999.00,
      "stock": 100,
      "startTime": "2024-01-01T10:00:00",
      "endTime": "2024-01-01T12:00:00"
    }
  ]
}`

const seckillExample = `{
  "productId": 1,
  "userId": 1
}`

const seckillResponse = `{
  "success": true,
  "code": 200,
  "message": "ç§’æ€æˆåŠŸ",
  "data": {
    "orderId": "ORD20240101001",
    "productId": 1,
    "userId": 1,
    "status": "SUCCESS"
  }
}`

const orderListResponse = `{
  "success": true,
  "code": 200,
  "message": "è·å–æˆåŠŸ",
  "data": {
    "records": [
      {
        "id": "ORD20240101001",
        "productName": "iPhone 15 Pro",
        "quantity": 1,
        "price": 7999.00,
        "totalAmount": 7999.00,
        "status": 1,
        "createTime": "2024-01-01T10:30:00"
      }
    ],
    "total": 1,
    "current": 1,
    "size": 10
  }
}`
</script>

<style scoped>
.api-docs-container {
  padding: 20px;
}

.header-section {
  margin-bottom: 20px;
}

.header-section h2 {
  color: #333;
  margin: 0;
}

.service-intro {
  margin-bottom: 30px;
  padding: 20px;
  background-color: #f8f9fa;
  border-radius: 8px;
}

.service-intro h3 {
  margin: 0 0 10px 0;
  color: #333;
}

.service-intro p {
  margin: 5px 0;
  color: #666;
}

.api-section {
  margin-bottom: 40px;
  padding-bottom: 20px;
  border-bottom: 1px solid #e4e7ed;
}

.api-section h4 {
  color: #409eff;
  margin: 0 0 10px 0;
  font-family: 'Courier New', monospace;
}

.api-desc {
  color: #666;
  margin-bottom: 20px;
}

.api-section h5 {
  margin: 20px 0 10px 0;
  color: #333;
}

.code-block {
  background-color: #f6f8fa;
  border: 1px solid #e1e4e8;
  border-radius: 6px;
  padding: 16px;
  font-family: 'Courier New', monospace;
  font-size: 14px;
  line-height: 1.45;
  overflow-x: auto;
  white-space: pre;
}

.common-docs h3 {
  margin: 30px 0 15px 0;
  color: #333;
}

.common-docs p {
  margin: 10px 0;
  color: #666;
  line-height: 1.6;
}
</style>
